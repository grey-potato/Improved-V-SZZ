# V-SZZ 项目文档索引 📚

欢迎使用V-SZZ（Vulnerability SZZ）项目！本索引帮助你快速找到所需信息。

---

## 🎯 快速导航

### 新手入门
1. **[使用说明.md](使用说明.md)** - 从零开始运行V-SZZ
   - ✅ 环境配置完成情况
   - 📦 依赖安装指南
   - 🚀 快速开始步骤
   - 💡 故障排除

### 深度理解
2. **[V-SZZ代码详解.md](V-SZZ代码详解.md)** - 完整的代码讲解
   - 🏗️ 整体架构
   - 🔄 核心算法流程图
   - 💻 每个方法的详细解析
   - 📊 与其他算法的对比
   - 🎨 代码示例

### 快速查阅
3. **[V-SZZ快速参考.md](V-SZZ快速参考.md)** - 速查手册
   - ⚡ 5个核心方法速查
   - 📝 关键数据结构
   - ⚙️ 配置参数清单
   - 💡 使用技巧
   - 🐛 常见问题Q&A

### 互动学习
4. **[demo_vszz.py](demo_vszz.py)** - 可视化演示脚本
   - 🎬 算法工作流程演示
   - 🔧 代码映射机制展示
   - 📊 算法对比展示
   - 运行命令：`python demo_vszz.py`

---

## 📂 项目文件结构

```
V-SZZ-main/
├── 📄 README.md                          # 项目概述
└── ICSE2022ReplicationPackage/
    ├── 📘 使用说明.md                    # 运行指南（中文）
    ├── 📗 V-SZZ代码详解.md               # 代码详解（中文）
    ├── 📙 V-SZZ快速参考.md               # 快速参考（中文）
    ├── 📄 README.md                      # 原始英文文档
    │
    ├── 🐍 Python脚本
    │   ├── main.py                       # 主程序入口
    │   ├── test_run.py                   # 环境测试（新增）
    │   ├── run_vszz_example.py           # 运行示例（新增）
    │   ├── demo_vszz.py                  # 算法演示（新增）
    │   ├── setting.py                    # 配置文件（已修改）
    │   ├── data_loader.py                # 数据加载
    │   ├── evaluate.py                   # 评估脚本
    │   └── extract_tag.py                # 版本标签提取
    │
    ├── 📊 数据文件
    │   └── data/
    │       ├── label.json                # 标注数据
    │       ├── c_cve_fix_detail.json     # C项目CVE
    │       └── java_cve_fix_detail.json  # Java项目CVE
    │
    └── 🔧 核心算法实现
        └── icse2021-szz-replication-package/
            └── tools/pyszz/szz/
                ├── my_szz.py             # V-SZZ实现 ⭐
                ├── b_szz.py              # B-SZZ
                ├── ag_szz.py             # AG-SZZ
                ├── ma_szz.py             # MA-SZZ
                ├── ra_szz.py             # RA-SZZ
                └── core/
                    ├── abstract_szz.py   # SZZ基类 ⭐
                    └── comment_parser.py # 注释解析
```

---

## 🎓 学习路径推荐

### 路径1：快速上手（30分钟）
```
1. 阅读 [使用说明.md](使用说明.md) 前半部分
   ↓
2. 运行 python test_run.py
   ↓
3. 运行 python demo_vszz.py
   ↓
4. 开始使用！
```

### 路径2：深入理解（2小时）
```
1. 运行 python demo_vszz.py 观看演示
   ↓
2. 阅读 [V-SZZ代码详解.md](V-SZZ代码详解.md)
   ↓
3. 查看源码 my_szz.py 和 abstract_szz.py
   ↓
4. 阅读 [V-SZZ快速参考.md](V-SZZ快速参考.md)
   ↓
5. 运行 python run_vszz_example.py
```

### 路径3：研究开发（1天）
```
1. 完成路径2的所有内容
   ↓
2. 阅读原论文（ICSE 2022）
   ↓
3. 分析 evaluate.py 了解评估方法
   ↓
4. 研究 extract_tag.py 了解版本识别
   ↓
5. 修改和扩展V-SZZ算法
```

---

## 🔑 核心概念速览

### V-SZZ是什么？
V-SZZ（Vulnerability SZZ）是一个**漏洞引入提交识别工具**，用于：
- 🔍 找出哪个提交引入了安全漏洞
- 📜 追溯代码的完整演化历史
- 🎯 为漏洞分析提供精确上下文

### V-SZZ的核心优势
```
传统SZZ：
  修复提交 --blame--> 引入提交 ✓

V-SZZ：
  修复提交 --递归blame--> 提交链 --> 真正的源头 ✓✓✓
  
特点：
  ✅ 多层递归追溯
  ✅ Java用AST，C/C++用相似度
  ✅ 返回完整历史链
  ✅ 专门针对漏洞优化
```

### 5个核心步骤
1. **输入**：漏洞修复提交
2. **分析**：获取删除/修改的代码行
3. **Blame**：找出谁修改了这些行
4. **映射**：追溯到前一版本
5. **递归**：重复3-4直到首次引入

---

## 📖 按主题查找

### 安装和配置
- [使用说明.md § 环境配置](使用说明.md#环境配置)
- [使用说明.md § 已安装的依赖](使用说明.md#2-已安装的依赖)

### 如何运行
- [使用说明.md § 如何运行V-SZZ](使用说明.md#如何运行-v-szz)
- [使用说明.md § 快速开始示例](使用说明.md#快速开始示例)
- [V-SZZ快速参考.md § 快速开始](V-SZZ快速参考.md#🚀-快速开始)

### 算法原理
- [V-SZZ代码详解.md § 核心算法流程](V-SZZ代码详解.md#核心算法流程)
- [V-SZZ代码详解.md § 关键类和方法详解](V-SZZ代码详解.md#关键类和方法详解)
- [demo_vszz.py](demo_vszz.py) - 运行查看可视化演示

### 代码详解
- [V-SZZ代码详解.md § find_bic()详解](V-SZZ代码详解.md#2-find_bic---查找漏洞引入提交)
- [V-SZZ代码详解.md § map_modified_line_java()详解](V-SZZ代码详解.md#3-map_modified_line_java---java代码映射)
- [V-SZZ代码详解.md § map_modified_line()详解](V-SZZ代码详解.md#4-map_modified_line---cc代码映射)

### 快速参考
- [V-SZZ快速参考.md § 5个核心方法速查](V-SZZ快速参考.md#📝-5个核心方法速查)
- [V-SZZ快速参考.md § 关键数据结构](V-SZZ快速参考.md#🔍-关键数据结构)
- [V-SZZ快速参考.md § 关键配置参数](V-SZZ快速参考.md#⚙️-关键配置参数)

### 对比分析
- [V-SZZ代码详解.md § 与其他SZZ算法的区别](V-SZZ代码详解.md#与其他szz算法的区别)
- [V-SZZ快速参考.md § 算法特点对比](V-SZZ快速参考.md#🎨-算法特点对比)

### 故障排除
- [使用说明.md § 故障排除](使用说明.md#故障排除)
- [V-SZZ快速参考.md § 常见问题](V-SZZ快速参考.md#🐛-常见问题)

### 代码示例
- [V-SZZ代码详解.md § 代码示例](V-SZZ代码详解.md#代码示例)
- [run_vszz_example.py](run_vszz_example.py) - 完整运行示例
- [V-SZZ快速参考.md § 完整工作流程](V-SZZ快速参考.md#🔄-完整工作流程)

---

## 🛠️ 实用工具脚本

### 1. test_run.py - 环境测试
```bash
python test_run.py
```
**功能**：
- ✅ 检查配置是否正确
- 📊 显示可用项目列表
- 🔍 验证数据文件完整性

### 2. demo_vszz.py - 算法演示
```bash
python demo_vszz.py
```
**功能**：
- 🎬 可视化展示V-SZZ工作流程
- 🔧 演示代码映射机制
- 📊 对比不同SZZ算法

### 3. run_vszz_example.py - 运行示例
```bash
python run_vszz_example.py
```
**功能**：
- 🚀 完整的V-SZZ运行示例
- 📝 展示输出格式
- 💡 提供调试信息

### 4. main.py - 主程序
```bash
python main.py
```
**功能**：
- 🔄 批量处理项目
- 📊 生成结果文件
- ⚙️ 可选择不同SZZ算法

---

## 🎯 常见使用场景

### 场景1：快速测试V-SZZ
```bash
# 1. 测试环境
python test_run.py

# 2. 查看演示
python demo_vszz.py

# 3. 运行示例（需要先克隆仓库）
python run_vszz_example.py
```

### 场景2：分析特定CVE
```python
from szz.my_szz import MySZZ

# 初始化
my_szz = MySZZ(
    repo_full_name='project-name',
    repos_dir='repos/',
    use_temp_dir=False
)

# 分析
fix_commit = 'abc123'
impacted = my_szz.get_impacted_files(fix_commit, ['java'])
bics = my_szz.find_bic(fix_commit, impacted)
```

### 场景3：批量处理项目
```python
# 编辑main.py
project_commits = load_annotated_commits()
for project in project_commits:
    run_szz(project, project_commits[project], 'my')  # V-SZZ
```

### 场景4：自定义扩展
```python
# 继承MySZZ
class MyCustomSZZ(MySZZ):
    def custom_filter(self, commits):
        # 自定义过滤逻辑
        pass
```

---

## 📊 支持的项目类型

### Java项目 ✅
- ✓ 使用AST映射（精确）
- ✓ 识别Insert/Update/Delete
- ✓ 需要ASTMapEval.jar

**示例项目**：activemq, commons-compress, cxf, lucene-solr

### C/C++项目 ✅
- ✓ 使用字符串相似度匹配
- ✓ Levenshtein距离计算
- ✓ 阈值可调整（默认0.75）

**示例项目**：linux, git, openssl

---

## 🔗 相关资源

### 学术资源
- 📄 **论文**：ICSE 2022 - "SZZ for Vulnerability: Automatic Identification of Version Ranges Affected by CVE Vulnerabilities"
- 🔬 **数据集**：包含46个项目的漏洞修复提交

### 技术资源
- 🐙 **GitHub**: [原始仓库](https://github.com/...)
- 📚 **PyDriller文档**: [pydriller.readthedocs.io](https://pydriller.readthedocs.io)
- 📚 **GitPython文档**: [gitpython.readthedocs.io](https://gitpython.readthedocs.io)

### 工具依赖
- ☕ **Java** (8+): 用于AST映射
- 🐍 **Python** (3.7+): 运行环境
- 📦 **Git**: 版本控制

---

## 🤝 贡献指南

如果你想改进文档或代码：

1. 📝 **文档改进**
   - 发现错误？直接修改相应的.md文件
   - 需要补充？添加到对应章节

2. 💻 **代码改进**
   - 优化算法？修改my_szz.py
   - 添加功能？继承MySZZ类

3. 🧪 **测试增强**
   - 添加测试用例到test_run.py
   - 创建新的演示脚本

---

## ❓ 获取帮助

### 问题分类

| 问题类型 | 查看文档 |
|---------|---------|
| 环境配置 | [使用说明.md](使用说明.md) |
| 算法理解 | [V-SZZ代码详解.md](V-SZZ代码详解.md) |
| 快速查询 | [V-SZZ快速参考.md](V-SZZ快速参考.md) |
| 运行错误 | [使用说明.md § 故障排除](使用说明.md#故障排除) |
| API使用 | [V-SZZ快速参考.md](V-SZZ快速参考.md) |

### 调试步骤
1. 运行 `python test_run.py` 检查环境
2. 查看相关文档的故障排除部分
3. 启用DEBUG日志查看详细信息
4. 运行演示脚本理解流程

---

## 📅 更新日志

### 2026-01-12
- ✅ 创建中文文档体系
- ✅ 修复PyDriller兼容性问题
- ✅ 添加演示和示例脚本
- ✅ 完善使用说明和故障排除

---

## 📞 联系方式

- 📧 **问题反馈**: 通过GitHub Issues
- 💬 **讨论交流**: 通过GitHub Discussions
- 📖 **文档建议**: 直接提交PR

---

**祝你使用愉快！如有问题，请参考上述文档或运行演示脚本。** 🎉

---

_最后更新：2026-01-12_
_文档版本：1.0_
_适用于：V-SZZ ICSE2022 Replication Package_
